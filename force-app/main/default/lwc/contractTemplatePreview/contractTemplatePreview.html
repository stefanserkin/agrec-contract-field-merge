<template>

    <lightning-spinner lwc:if={isLoading} alternative-text="Loading..." size="medium"></lightning-spinner>
    
    <template lwc:if={isShowPreview}>

        <lightning-button
            label="Back"
            icon-name="utility:back"
            icon-position="left"
            onclick={handleBack}
            class="slds-var-m-around_medium"
        ></lightning-button>
        
        <div>
            <lightning-formatted-rich-text
                value={previewContent}
                class="slds-var-m-around_medium"
            ></lightning-formatted-rich-text>
        </div>
    </template>

    <template lwc:else>
        <lightning-record-picker
            label="Select a Contract to Preview"
            placeholder="Search by Contract and Form Name or Account Name..."
            object-api-name="TREX1__Contract_and_Form__c"
            display-info={displayInfo}
            matching-info={matchingInfo}
            onchange={handleContractSelection}
        ></lightning-record-picker>

        <template lwc:if={selectedContractId}>
            <lightning-record-view-form
                object-api-name="TREX1__Contract_and_Form__c"
                record-id={selectedContractId}
            >
                <lightning-output-field field-name={fields.id}> </lightning-output-field>
                <lightning-output-field field-name={fields.name}> </lightning-output-field>
                <lightning-output-field field-name={fields.status}> </lightning-output-field>
                <lightning-output-field field-name={fields.contact}> </lightning-output-field>
                <lightning-output-field field-name={fields.account}> </lightning-output-field>
            </lightning-record-view-form>

            <lightning-button
                variant="brand"
                label="Generate Preview"
                onclick={handleShowPreview}
            ></lightning-button>
        </template>
    </template>

</template>